"use strict";(self["webpackChunkmy_github_page"]=self["webpackChunkmy_github_page"]||[]).push([[898],{54898:function(e,l,a){a.r(l),a.d(l,{default:function(){return f}});a(98992),a(54520),a(81454);var o=a(56768),s=a(24232),n=a(45130),t=a(90144);const i={class:"anime-image-tool"},r={class:"category-selector"},u=["value"],c={class:"masonry-grid"},v={class:"image-wrapper"},g=["src","alt"],d={class:"image-overlay"},m=["onClick"],p={key:0,class:"loading-container"};var y={__name:"AnimeImageTool",setup(e){const l=["waifu","neko","shinobu","megumin","bully","cuddle","cry","hug","awoo","kiss","lick","pat","smug","bonk","yeet","blush","smile","wave","highfive","handhold"],a=(0,t.KR)("waifu"),y=(0,t.KR)([]),k=(0,t.KR)(!1),h=(0,t.KR)(null);let f=null;const w=e=>e.charAt(0).toUpperCase()+e.slice(1),b=e=>new Promise(((l,a)=>{const o=new Image;o.onload=()=>l(e),o.onerror=()=>a(e),o.src=e})),C=async()=>{if(console.log("hello"),!k.value){k.value=!0;try{const e=Array(10).fill().map((async()=>{const e=await fetch(`https://api.waifu.pics/sfw/${a.value}`),l=await e.json();return l.url})),l=await Promise.all(e),o=await Promise.allSettled(l.map((e=>b(e)))),s=o.filter((e=>"fulfilled"===e.status)).map((e=>e.value)).filter((e=>!y.value.includes(e))),n=s.filter((e=>!y.value.includes(e)));y.value=[...y.value,...n]}catch(e){console.error("Failed to fetch images:",e)}finally{k.value=!1,K()}}},L=()=>{y.value=[],C()},_=e=>{window.open(e,"_blank")},I=e=>{const l=e.target,a=l.closest(".masonry-item");a&&(a.style.opacity="1")},E=e=>{e.target.src="/api/placeholder/300/300",e.target.alt="图片加载错误"},K=()=>{f=new IntersectionObserver((e=>{console.log(k.value),console.log("hello3"),e[0].isIntersecting&&!k.value&&(console.log("hello2"),C())}),{root:document.body,threshold:1,rootMargin:"200px"}),h.value&&(console.log(h.value.getBoundingClientRect()),f.observe(h.value))};return(0,o.sV)((()=>{C(),K()})),(0,o.hi)((()=>{f&&h.value&&f.unobserve(h.value)})),(e,t)=>((0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("div",r,[t[1]||(t[1]=(0,o.Lk)("label",{for:"category-select",class:"sr-only"},"选择动漫图片类别",-1)),t[2]||(t[2]=(0,o.eW)(" 选择动漫图片类别： ")),(0,o.bo)((0,o.Lk)("select",{id:"category-select","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),onChange:L,class:"category-dropdown"},[((0,o.uX)(),(0,o.CE)(o.FK,null,(0,o.pI)(l,(e=>(0,o.Lk)("option",{key:e,value:e},(0,s.v_)(w(e)),9,u))),64))],544),[[n.u1,a.value]])]),(0,o.Lk)("div",c,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(y.value,((e,l)=>((0,o.uX)(),(0,o.CE)("div",{key:`${e}-${l}`,class:"masonry-item"},[(0,o.Lk)("div",v,[(0,o.Lk)("img",{src:e,alt:`Anime ${a.value} ${l}`,loading:"lazy",class:"image",onError:E,onLoad:I},null,40,g),(0,o.Lk)("div",d,[(0,o.Lk)("button",{onClick:l=>_(e),class:"original-image-button"}," 打开原图 ",8,m)])])])))),128))]),k.value?((0,o.uX)(),(0,o.CE)("div",p,t[3]||(t[3]=[(0,o.Lk)("div",{class:"loading-spinner"},null,-1)]))):(0,o.Q3)("",!0),(0,o.Lk)("div",{ref_key:"loadMoreTrigger",ref:h,class:"load-more-trigger"},null,512)]))}},k=a(71241);const h=(0,k.A)(y,[["__scopeId","data-v-223af5ae"]]);var f=h}}]);
//# sourceMappingURL=898.c8e7728a.js.map